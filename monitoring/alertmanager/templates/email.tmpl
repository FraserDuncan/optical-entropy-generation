{{ define "email.entropy.subject" }}
[{{ .Status | toUpper }}] Optical Entropy: {{ .GroupLabels.alertname }}
{{ end }}

{{ define "email.entropy.html" }}
<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    .alert { padding: 15px; margin: 10px 0; border-radius: 4px; }
    .firing { background-color: #ffebee; border-left: 4px solid #f44336; }
    .resolved { background-color: #e8f5e9; border-left: 4px solid #4caf50; }
    .label { display: inline-block; padding: 2px 8px; margin: 2px; background: #e0e0e0; border-radius: 3px; font-size: 12px; }
    .severity-critical { background: #f44336; color: white; }
    .severity-warning { background: #ff9800; color: white; }
    .severity-info { background: #2196f3; color: white; }
    h2 { margin-top: 0; }
    .meta { color: #666; font-size: 14px; }
    .runbook { margin-top: 10px; }
    .runbook a { color: #1976d2; }
  </style>
</head>
<body>
  <h1>Optical Entropy Alert</h1>

  {{ range .Alerts }}
  <div class="alert {{ if eq .Status "firing" }}firing{{ else }}resolved{{ end }}">
    <h2>{{ .Labels.alertname }}</h2>

    <p><span class="label severity-{{ .Labels.severity }}">{{ .Labels.severity | toUpper }}</span></p>

    <p><strong>Status:</strong> {{ .Status | toUpper }}</p>
    <p><strong>Summary:</strong> {{ .Annotations.summary }}</p>
    <p><strong>Description:</strong> {{ .Annotations.description }}</p>

    <p class="meta">
      <strong>Started:</strong> {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}<br>
      {{ if .EndsAt }}
      <strong>Ended:</strong> {{ .EndsAt.Format "2006-01-02 15:04:05 MST" }}
      {{ end }}
    </p>

    {{ if .Annotations.runbook_url }}
    <div class="runbook">
      <strong>Runbook:</strong> <a href="{{ .Annotations.runbook_url }}">{{ .Annotations.runbook_url }}</a>
    </div>
    {{ end }}

    <h3>Labels</h3>
    <p>
      {{ range .Labels.SortedPairs }}
      <span class="label">{{ .Name }}: {{ .Value }}</span>
      {{ end }}
    </p>
  </div>
  {{ end }}

  <hr>
  <p style="color: #999; font-size: 12px;">
    This alert was generated by Alertmanager for the Optical Entropy Generation system.
    <br>
    <a href="{{ template "__alertmanagerURL" . }}">View in Alertmanager</a> |
    <a href="http://grafana:3000/d/entropy-overview">View in Grafana</a>
  </p>
</body>
</html>
{{ end }}
